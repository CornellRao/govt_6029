df %>%
filter(CATH < 40) %>%
summarise(Pct40Cath_GDP_mean = mean(GDPW))
df %>%
summarise(Median_EDT= median(EDT, na.rm = T))
summary(df$EDT)
df %>%
summarise(Median_EDT= median(EDT))
, na.rm = T
df %>%
summarise(Median_EDT= median(EDT, na.rm = T))
summary(df$EDT)
df %>%
filter(YEAR == 1985) %>%
summarise(Median_EDT= median(EDT, na.rm = T))
df %>%
filter(YEAR == 1985) %>%
select(EDT, CTYNAME) %>%
arrange(EDT)
df %>%
filter(YEAR == 1985, EDT>4&EDT<6) %>%
select(EDT, CTYNAME) %>%
arrange(EDT)
df %>%
filter(YEAR == 1985, EDT>5&EDT<7) %>%
select(EDT, CTYNAME) %>%
arrange(EDT)
df %>%
filter(YEAR == 1985, EDT>5.5&EDT<6.5) %>%
select(EDT, CTYNAME) %>%
arrange(EDT)
df %>%
filter(YEAR == 1985, EDT>5&EDT<6.5) %>%
select(EDT, CTYNAME) %>%
arrange(EDT)
df %>%
filter(YEAR == 1985, EDT>5&EDT<6) %>%
select(EDT, CTYNAME) %>%
arrange(EDT)
df %>%
filter(YEAR == 1985, EDT>5&EDT<6.5) %>%
select(EDT, CTYNAME) %>%
arrange(EDT)
df %>%
filter(YEAR == 1985, REG == 1) %>%
summarise(medianEDT = median(EDT, na.rm = T))
df %>%
filter(YEAR == 1985, REG == 1, EDT>7&EDT<9) %>%
select(EDT, CTYNAME) %>%
arrange(EDT)
df %>%
filter(CATH < 40) %>%
summarise(Pct40Cath_GDP_mean = mean(GDPW))
df %>%
summarise(All_rel_GDP_mean = mean(GDPW))
df %>%
summarise(df %>% filter(CATH < 40), All_rel_GDP_mean = mean(GDPW))
df %>%
summarise_if(.,df$CATH <40, "GDPW", mean)
df %>%
summarise(df %>% filter(CATH < 40), All_rel_GDP_mean = mean(GDPW))
df %>%
summarise(All_rel_GDP_mean = mean(GDPW)) %>%
filter(CATH < 40) %
df %>%
summarise(All_rel_GDP_mean = mean(GDPW)) %>%
filter(CATH < 40) %>%
summarise(Pct40Cath_GDP_mean = mean(GDPW))
df %>%
summarise(All_rel_GDP_mean = mean(GDPW))
# DO NOT ALTER CODE IN THIS CHUNK
knitr::opts_chunk$set(message = F, warning = F)
library(tidyverse)
library(pander)
df %>%
mutate(ELF_3_cat = case_when(ELF60 < .60 ~ "less",
ELF60 > .60 ~ "more",
is.na(ELF60) ~ "missing")) %>%
group_by(ELF_3_cat) %>%
summarise(Mean = mean(GDPW)) %>%
pander()
df %>%
mutate(elf3cat = case_when(ELF60 < .60 ~ "less",
ELF60 > .60 ~ "more")) %>%
group_by(elf3cat) %>%
summarise(mean(GDPW)) %>%
pander()
?pander
lm(CIVLIB~ CATH + GDPW, data = df)
summary(lm(CIVLIB~ CATH + GDPW, data = df)) %>%
pander()
summary(lm(CIVLIB~ CATH + GDPW, data = df)) %>%
kable()
library(kable)
library(stargazer)
```{r, results='asis'}
summary(lm(CIVLIB~ CATH + GDPW, data = df)) %>%
stargazer()
summary(lm(CIVLIB~ CATH + GDPW, data = df)) %>%
stargazer(type = "html" )
# DO NOT ALTER CODE IN THIS CHUNK
knitr::opts_chunk$set(message = F, warning = F)
library(tidyverse)
library(pander)
library(stargazer)
lm(CIVLIB~ CATH + GDPW, data = df) %>%
stargazer(type = "html" )
df %>% group_by(NEWC) %>%
summarise(Pct25 = quantile(EDT, probs = 0.25, na.rm = T),
Pct75 = quantile(EDT, probs = 0.75, na.rm = T)) %>%
stargazer(type = "html" )
df %>%
filter(YEAR == 1985, REG == 1, EDT>7&EDT<9) %>%
select(EDT, CTYNAME) %>%
arrange(EDT)
df %>% group_by(NEWC) %>%
summarise(Pct25 = quantile(EDT, probs = 0.25, na.rm = T),
Pct75 = quantile(EDT, probs = 0.75, na.rm = T))
ggplot(df, aes(GDPW)) +
geom_histogram()
df %>% group_by(NEWC) %>%
summarise(Pct25 = quantile(EDT, probs = 0.25, na.rm = T),
Pct75 = quantile(EDT, probs = 0.75, na.rm = T))
df %>% group_by(NEWC) %>%
summarise(Pct25 = quantile(EDT, probs = 0.25, na.rm = T),
Pct75 = quantile(EDT, probs = 0.75, na.rm = T)) %>%
pander()
summarise(Pct25 = quantile(EDT, probs = c(0.25, 0.75)
)
)
df %>% group_by(NEWC) %>%
summarise(quantile(EDT, probs = c(0.25, 0.75)))
df %>% group_by(NEWC) %>%
summarise(quantile(EDT, probs = c(0.25, 0.75)))
df %>% group_by(NEWC) %>%
summarise(quantile(EDT, probs = c(0.25, 0.75), na.rm = T))
df %>% group_by(NEWC) %>%
summarise(quantile(EDT, probs = c(0.25, 0.75), na.rm = T))
df %>% group_by(NEWC) %>%
summarise(quantile(EDT))
df %>% group_by(NEWC) %>%
summarise(quantile(EDT, na.rm = T))
df %>% group_by(NEWC) %>%
summarise(quantile(EDT, na.rm = T))
df %>% group_by(NEWC) %>%
summarise(quantile(EDT, na.rm = T))
df %>% group_by(NEWC) %>%
summarise(quantile(EDT, na.rm = T))
df %>% group_by(NEWC) %>%
summarise(Pct25 = quantile(EDT, probs = 0.25, na.rm = T),
Pct75 = quantile(EDT, probs = 0.75, na.rm = T))
df %>% group_by(NEWC) %>%
summarise(Pct25 = quantile(EDT, probs = 0.25, na.rm = T),
Pct75 = quantile(EDT, probs = 0.75, na.rm = T))
df %>% group_by(NEWC) %>%
summarise(quantile(EDT, na.rm = T))
df %>% group_by(NEWC) %>%
summarise(`25%` = quantile(EDT, probs = 0.25, na.rm = T),
`75%` = quantile(EDT, probs = 0.75, na.rm = T))
df %>% group_by(NEWC) %>%
summarise(quantile(EDT, na.rm = T))
df %>%
group_by(NEWC) %>%
summarise(`25%` = quantile(EDT, probs = 0.25, na.rm = T))
df %>%
group_by(NEWC) %>%
summarise(quantile(EDT, probs = 0.25, na.rm = T))
df %>%
group_by(NEWC) %>%
summarise(quantile(EDT, na.rm = T))
??quantile
probs = 0.25
df %>%
group_by(NEWC) %>%
summarise(quantile(EDT, probs = 0.25, na.rm = T))
df %>%
group_by(NEWC) %>%
summarise(`25%` = quantile(EDT, probs = 0.25, na.rm = T),
`75%` = quantile(EDT, probs = 0.75, na.rm = T)) %>%
pander()
ggplot(df, aes(log10(GDPW),  POLLIB )) +
geom_jitter(height = .20, alpha = .5)
ggplot(df, aes(GDPW,  POLLIB )) +
geom_jitter(height = .20, alpha = .5)
ggplot(df, aes(y = GDPW, x = factor(OIL))) +
geom_boxplot() +
geom_smooth()
ggplot(df, aes(log10(GDPW),  POLLIB )) +
geom_jitter(height = .20, alpha = .5) +
+
geom_smooth()
ggplot(df, aes(log10(GDPW),  POLLIB )) +
geom_jitter(height = .20, alpha = .5) +
geom_smooth()
ggplot(df, aes(GDPW,  POLLIB )) +
geom_jitter(height = .20, alpha = .5) +
geom_smooth()
ggplot(df, aes(log10(GDPW),  POLLIB )) +
geom_jitter(height = .20, alpha = .5) +
geom_smooth()
class(df$OIL)
ggplot(df, aes(y = GDPW, x = OIL)) +
geom_boxplot()
str(df)
glimpse(df)
df %>% class(OIL)
class(df$OIL)
df %>%
filter(CATH < 40) %>%
summarise(Pct40Cath_GDP_mean = mean(GDPW))
df %>%
summarise(All_rel_GDP_mean = mean(GDPW))
df %>%
filter(YEAR == 1985) %>%
summarise(Median_EDT= median(EDT, na.rm = T))
df %>%
filter(YEAR == 1985, EDT>5&EDT<6.5) %>%
select(EDT, CTYNAME) %>%
arrange(EDT)
df %>%
filter(YEAR == 1985, REG == 1) %>%
summarise(medianEDT = median(EDT, na.rm = T))
df %>%
filter(YEAR == 1985, REG == 1, EDT>7&EDT<9) %>%
select(EDT, CTYNAME) %>%
arrange(EDT)
df %>%
group_by(NEWC) %>%
summarise(`25%` = quantile(EDT, probs = 0.25, na.rm = T),
`75%` = quantile(EDT, probs = 0.75, na.rm = T))
knitr::opts_chunk$set(echo = TRUE)
democracy$NEWC <- as.logical(democracy$NEWC)
democracy <- df
democracy$NEWC <- as.logical(democracy$NEWC)
democracy %>% filter(NEWC == T) %>% select(ELF60) %>% quantile(probs = c(0.25,0.75), na.rm = T)
democracy %>% filter(NEWC == F) %>% select(ELF60) %>% quantile(probs = c(0.25,0.75), na.rm = T)
df %>%
group_by(NEWC) %>%
summarise(`25%` = quantile(EDT, probs = 0.25, na.rm = T),
`75%` = quantile(EDT, probs = 0.75, na.rm = T))
df %>%
group_by(NEWC) %>%
summarise(`25%` = quantile(EDT, probs = 25, na.rm = T),
`75%` = quantile(EDT, probs = 75, na.rm = T))
df %>%
group_by(NEWC) %>%
summarise(`25%` = quantile(ELF60, probs = .25, na.rm = T),
`75%` = quantile(ELF60, probs = .75, na.rm = T))
df %>%
group_by(NEWC) %>%
summarise(`25%` = quantile(ELF60, probs = .25, na.rm = T),
`75%` = quantile(ELF60, probs = .75, na.rm = T)) %>%
pander()
install.packages("kableExtra")
library(knitr)
df %>%
group_by(NEWC) %>%
summarise(`25%` = quantile(ELF60, probs = .25, na.rm = T),
`75%` = quantile(ELF60, probs = .75, na.rm = T)) %>%
kable()
panderOptions()
set.seed(1121)
(x=rnorm(20))
<<boring-plots, fig.width=5, fig.height=5, out.width='.45\\linewidth', fig.show='hold'>>=
## two plots side by side (option fig.show='hold')
boxplot(x)
hist(x,main='')
@
unlink('minim_rm_cache', recursive = TRUE)
library(haven)
library(labelled)
library(tidyverse)
library(pander)
library(forcats)
library(stargazer)
lns <-  read_dta("lns_full.dta")
setwd("C:/Users/sig35/Google Drive/Work/Teaching/Courses/Advanced Regression Analysis/govt_6029/Labs/lab7")
lns <-  read_dta("lns_full.dta")
lns <-  read_dta("lns_full.dta")
View(lns)
lns <- haven::as_factor(lns, only_labelled = TRUE)
View(lns)
lns %>% count(natprob)
lns %>% count(natprob) %>%
mutate(pct = prop.table(n)) %>% pander()
ggplot(lns, aes(x = natprob)) +
geom_bar()
ggplot(lns, aes(x = natprob)) +
geom_bar() +
coord_flip()
lns <- lns %>% mutate(natprob_r =
natprob %>%
fct_infreq() %>%
fct_rev())
lns %>% count(natprob_r) %>%
mutate(pct = prop.table(n)) %>% pander()
ggplot(lns, aes(x = natprob_r)) +
geom_bar() +
coord_flip()
ggplot(lns, aes(x = natprob %>%
fct_infreq() %>%
fct_rev()
)) +
geom_bar( fill = "blue") +  # added blue as the color for the bars
coord_flip() + # still wnat the coordinted flipped
labs(x = "",
y = "Main Issue",
title= "What is the main problem facing the country") +  # here I can specify labels and titles
theme_minimal()
ggplot(lns, aes(x = natprob %>%
fct_infreq() %>%
fct_rev()
)) +
geom_bar( fill = "blue") +  # added blue as the color for the bars
coord_flip() + # still wnat the coordinted flipped
labs(x = "",
y = "Frq. Main Issue",
title= "What is the main problem facing the country") +  # here I can specify labels and titles
theme_minimal()
colourpicker:::plotHelperAddin()
ggplot(lns, aes(x =
latprob %>%
fct_infreq %>%
fct_rev())) +
geom_bar(fill = "#66c2a5") +
coord_flip() +
labs(x = "",
title= "What is the main problem facing Latinos") +
theme_minimal()
prop.table(table(lns$poordisc))
prop.table(table(lns$newgen))
table(lns$poordisc, lns$newgen)
prop.table(table(lns$poordisc,
lns$newgen), 2)
prop.table(table(lns$poordisc,
lns$newgen), 2)
lns <- lns %>%
mutate(poordisc_r =
recode(poordisc,
"dk" = NA_character_))
lns <- lns %>% mutate(poord_r =
fct_relevel(poordisc_r, "strongly disagree", "somewhat disagree",
"somewhat agree", "strongly agree"))
lns %>%
group_by(newgen) %>%
count(poord_r) %>%
mutate(prop = prop.table(n)) %>%
na.omit()
poor_can<- lns %>%
group_by(newgen) %>%
count(poord_r) %>%
mutate(prop = prop.table(n)) %>%
na.omit()
View(poor_can)
View(poor_can)
ggplot(poor_can, aes(x=factor(newgen),
y = prop, fill = poord_r)) +
geom_bar(stat= "identity")
ggplot(poor_can, aes(x = factor(newgen), y = prop,
fill = poord_r)) +
geom_bar(stat= "identity") +
labs(x = "Generation",
y = "Proportion",
title= "Poor people can get ahead if they work hard",
fill =  "Support") +
scale_fill_brewer(palette = "Dark2")
ggplot(poor_can, aes(x = factor(newgen), y = prop,
fill = poord_r)) +
geom_bar(stat= "identity") +
labs(x = "Generation",
y = "Proportion",
title= "Poor people can get ahead if they work hard",
fill =  "Support")
ggplot(poor_can, aes(x = factor(newgen), y = prop,
fill = poord_r)) +
geom_bar(stat= "identity") +
labs(x = "Generation",
y = "Proportion",
title= "Poor people can get ahead if they work hard",
fill =  "Support") +
scale_fill_brewer(palette = "Dark2") +
theme_minimal()
ggplot(poor_can, aes(x = factor(newgen), y = prop,
fill = poord_r)) +
geom_bar(stat= "identity") +
labs(x = "Generation",
y = "Proportion",
title= "Poor people can get ahead if they work hard",
fill =  "Support") +
scale_fill_brewer(palette = " BrBG") +
theme_minimal()
ggplot(poor_can, aes(x = factor(newgen), y = prop,
fill = poord_r)) +
geom_bar(stat= "identity") +
labs(x = "Generation",
y = "Proportion",
title= "Poor people can get ahead if they work hard",
fill =  "Support") +
scale_fill_brewer(palette = "BrBG") +
theme_minimal()
ggplot(poor_can, aes(x = factor(newgen), y = prop,
fill = poord_r)) +
geom_bar(stat= "identity") +
labs(x = "Generation",
y = "Proportion",
title= "Poor people can get ahead if they work hard",
fill =  "Support") +
scale_fill_brewer(palette = "BrBG") +
theme_minimal()
lns <- lns %>%  mutate(latdisc_r =  recode(latdisc, 'dk' = NA_character_))
latinos_can<- lns %>%
group_by(newgen) %>%
count(latdisc_r) %>%
mutate(prop = prop.table(n)) %>%
na.omit()
ggplot(latinos_can, aes(x = factor(newgen), y = prop,
fill = latdisc_r)) +
geom_bar(stat= "identity") +
theme_minimal() +
labs(x = "Generation",
y = "Proportion",
title= "Latinos can get ahead if they work hard",
fill = "Support") +
scale_fill_brewer(palette = "Set2") +
scale_x_discrete(labels = c("First", "1.5ers", "Second", "Third", "Fourth"))
ggplot(latinos_can, aes(x = factor(newgen), y = prop,
fill = latdisc_r)) +
geom_bar(stat= "identity") +
theme_minimal() +
labs(x = "Generation",
y = "Proportion",
title= "Latinos can get ahead if they work hard",
fill = "Support") +
scale_fill_brewer(palette = "PiYG") +
scale_x_discrete(labels = c("First", "1.5ers", "Second", "Third", "Fourth"))
latinos_can<- lns %>%
group_by(newgen) %>%
count(latdisc_r) %>%
mutate(prop = prop.table(n)) %>%
na.omit()
ggplot(latinos_can, aes(x = factor(newgen), y = prop,
fill = latdisc_r)) +
geom_bar(stat= "identity") +
theme_minimal() +
labs(x = "Generation",
y = "Proportion",
title= "Latinos can get ahead if they work hard",
fill = "Support") +
scale_fill_brewer(palette = "PiYG") +
scale_x_discrete(labels = c("First", "1.5ers", "Second", "Third", "Fourth"))
lns %>% count(whydisc)
lns<- lns %>% mutate(whydisc_r = recode(whydisc, "dk/na" = NA_character_))
prop.table(table(lns$whydisc_r,lns$newgen), 2)
prop.table(table(lns$whydisc_r,lns$newgen), 2)
prop.table(table(lns$whydisc_r,lns$newgen), 2) %>% pander()
lns <- lns %>% mutate(discindex  = dfired_r + dbadpol_r+ dhousing_r+drestaur_r)
prop.table(table(lns$discindx))
prop.table(table(lns$discindx, lns$newgen), 2)*100
lns$poord_r <- as.numeric(lns$poord_r)
summary(model1<-lm(poord_r ~ newgen, data = lns))
hypdata<- data.frame(newgen=c(1,2))
predict(model1, hypdata)
hypdata<- data.frame(newgen=c(1, 1.5, 4))
predict(model1, hypdata)
summary(fullmodel <- lm(poord_r ~ newgen + discindx + trieduc + age + mexican + income + female, data = lns))
hypdata_mex<- lns %>% with(expand.grid(newgen=c(1,4),
discindx = mean(discindx,  na.rm = TRUE),
trieduc = mean(trieduc,  na.rm = TRUE),
age = mean(age,  na.rm = TRUE),
mexican = c(0,1),
income = mean(income,  na.rm = TRUE),
female = mean(female,  na.rm = TRUE)))
hypdata_mex
predict_df_mex <- predict(fullmodel, hypdata_mex, interval = "confidence", level = .90)
predict_df_mex
plot_predicts_mex <- cbind(predict_df_mex, hypdata_mex)
plot_predicts_mex
ggplot(plot_predicts_mex, aes(y = fit, x = factor(newgen),
color = factor(mexican),
ymin = lwr,
ymax= upr)) +
geom_pointrange(size = 1, position = position_dodge(width = .5)) +
theme_bw() +
labs(x = "Generation",
y = "Predicted Support",
title = "Poor People Can Get Ahead in Life if They Work Hard by Country of Origin",
color =  "Mexican")
hypdata2<- lns %>% with(expand.grid(newgen= mean(newgen, na.rm = TRUE),
discindx = seq(1,4),
trieduc = mean(trieduc,  na.rm = TRUE),
age = mean(age,  na.rm = TRUE),
mexican = mean(mexican,  na.rm = TRUE),
income = mean(income,  na.rm = TRUE),
female = mean(female,  na.rm = TRUE)))
hypdata2<- lns %>% with(expand.grid(newgen= mean(newgen, na.rm = TRUE),
discindx = seq(1,4),
trieduc = mean(trieduc,  na.rm = TRUE),
age = mean(age,  na.rm = TRUE),
mexican = mean(mexican,  na.rm = TRUE),
income = mean(income,  na.rm = TRUE),
female = mean(female,  na.rm = TRUE)))
predict_df2 <- predict(fullmodel, hypdata2, interval = "confidence")
plot_predicts2 <- cbind(predict_df2, hypdata2)
ggplot(plot_predicts2, aes(x = discindx, y = fit,
ymin = lwr,
ymax= upr)) +
geom_line() +
geom_ribbon(alpha = .6) +
theme_bw() +
labs(x = "Discrimination Index",
y = "Predicted Support",
title = "Poor People Can Get Ahead in Life if They Work Hard")
